(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{90715:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/exercises/view",function(){return t(85122)}])},85122:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ExerciseViewPage}});var a=t(85893),r=t(67294),l=t(11163),i=t(41664),n=t.n(i),d=t(39367),o=t(36008),c=t(46435);function ExerciseViewPage(){let{user:e,loading:s}=(0,d.a)(),t=(0,l.useRouter)(),{id:i,therapyPlanExerciseId:x,therapyPlanId:u}=t.query,[p,h]=(0,r.useState)(null),[m,g]=(0,r.useState)(null),[v,b]=(0,r.useState)(!0),[f,y]=(0,r.useState)(""),[N,j]=(0,r.useState)(""),[w,E]=(0,r.useState)(!1),[k,I]=(0,r.useState)(!1),[L,C]=(0,r.useState)({notes:"",painLevel:"",satisfaction:""});(0,r.useEffect)(()=>{if(!s&&!e){t.push("/login");return}i&&e&&loadExercise()},[i,e,s,t]);let loadExercise=async()=>{var e,s,t;try{b(!0);let s=await c.Ak.get(parseInt(i));if(s.success&&h(s.data.exercise),x&&u)try{let s=await c.NU.get(parseInt(u));if(s.success&&s.data.therapyPlan){let t=s.data.therapyPlan,a=null===(e=t.exercises)||void 0===e?void 0:e.find(e=>e.id===parseInt(x));a&&g(a)}}catch(e){console.error("Failed to load therapy plan exercise:",e)}}catch(e){y((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to load exercise")}finally{b(!1)}},handleCompleteExercise=async()=>{var s,a,r;if(!x||!e){y("Cannot complete exercise without therapy plan context");return}y(""),I(!0);try{let a=e.id;if("PATIENT"===e.role&&u)try{let e=await c.NU.get(parseInt(u));e.success&&(null===(s=e.data.therapyPlan)||void 0===s?void 0:s.patientId)&&(a=e.data.therapyPlan.patientId)}catch(e){console.error("Failed to get patient ID from plan:",e)}let r={therapyPlanExerciseId:parseInt(x),therapyPlanId:u?parseInt(u):void 0,exerciseId:null==p?void 0:p.id,notes:L.notes||void 0,painLevel:L.painLevel?parseInt(L.painLevel):void 0,painRating:L.painLevel?parseInt(L.painLevel):void 0,satisfaction:L.satisfaction?parseInt(L.satisfaction):void 0},l=await c.zP.create(a,r);l.success&&(j("Exercise marked as completed successfully!"),C({notes:"",painLevel:"",satisfaction:""}),setTimeout(()=>{t.push("/therapy-plans")},2e3))}catch(e){y((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Failed to complete exercise")}finally{I(!1)}};return s||v?(0,a.jsx)(o.Z,{children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"Loading exercise..."})})}):e&&p?(0,a.jsx)(o.Z,{children:(0,a.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(n(),{href:u?"/therapy-plans/".concat(u):"/therapy-plans",className:"text-blue-600 hover:text-blue-800 flex items-center mb-4",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:p.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ".concat((e=>{switch(e){case"BEGINNER":return"bg-green-100 text-green-800 border-green-200";case"INTERMEDIATE":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"ADVANCED":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(p.difficulty)),children:p.difficulty}),p.duration&&(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Duration: ",p.duration," minutes"]})]})]}),f&&(0,a.jsx)("div",{className:"mb-6 rounded-lg bg-red-50 border border-red-200 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,a.jsx)("div",{className:"ml-3 text-sm text-red-700",children:f})]})}),N&&(0,a.jsx)("div",{className:"mb-6 rounded-lg bg-green-50 border border-green-200 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,a.jsx)("div",{className:"ml-3 text-sm text-green-700",children:N})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:p.videoUrl?(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Exercise Video"}),(0,a.jsx)("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:(0,a.jsxs)("video",{className:"absolute top-0 left-0 w-full h-full rounded-lg",controls:!0,onEnded:()=>{E(!0)},onTimeUpdate:()=>{E(!0)},children:[(0,a.jsx)("source",{src:p.videoUrl,type:"video/mp4"}),"Your browser does not support the video tag."]})}),(0,a.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:w?"âœ“ Video watched. You can now mark this exercise as completed.":"Please watch the video to understand how to perform this exercise."})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No video available for this exercise"})]})}),p.description&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Description"}),(0,a.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:p.description})]}),p.instructions&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Instructions"}),(0,a.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap",children:p.instructions})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:x&&"PATIENT"===e.role&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 sticky top-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Complete Exercise"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pain Level (1-10)"}),(0,a.jsx)("input",{type:"number",min:"1",max:"10",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:L.painLevel,onChange:e=>C({...L,painLevel:e.target.value}),placeholder:"Optional"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Satisfaction (1-5)"}),(0,a.jsx)("input",{type:"number",min:"1",max:"5",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:L.satisfaction,onChange:e=>C({...L,satisfaction:e.target.value}),placeholder:"Optional"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,a.jsx)("textarea",{rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:L.notes,onChange:e=>C({...L,notes:e.target.value}),placeholder:"How did the exercise feel? Any observations?"})]}),(0,a.jsx)("button",{onClick:handleCompleteExercise,disabled:k||!w&&!!p.videoUrl,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Completing...":"Mark as Completed"}),!w&&p.videoUrl&&(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Please watch the video before marking as completed"})]})]})})]})]})}):null}}},function(e){e.O(0,[424,8,774,888,179],function(){return e(e.s=90715)}),_N_E=e.O()}]);